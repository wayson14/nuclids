      SUBROUTINE TLD(H4,N1,J1,H1,Z,W1,STPLTH)                           00010003
C
C  Berechnet Transmissionskoeffizienten in 'Double Precision' nach dem
C  optischen Modell, T(2*S+1,LMAX)
C  wird von OVER2 und OM aufgerufen
C  Stand: 3.5.1994
C
C-------------------------------------------------------------------    00040008
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION SG(2),S(16,4),F(101,2),G(101,3),R(2,3),H(502),A(502),B(500050000
     102),Q(502),D(300),E(300),Y(300),U(300),Z1(5),U1(7),Y1(7)          00060000
      COMMON/TLJ/ T(2,31),V(15),V1(3)                                   00070000
      DOUBLE PRECISION T,V,V1,H4,H1,Z,W1,STPLTH                         00080000
C     H4=0.0478326*AREDUCED*ELAB*AT/(AP+AT)=0.04783*AREDUCED*ECM=K**2   00090008
C     W1=0.0478326*AREDUCED                                             00100008
C     N1 OUTPUT,ESSENTIALLY ROUNDED UP VALUE OF V1(3)                   00110008
C     J1 OUTPUT (2S+1 OF PROJECTILE)                                    00120008
C     H1=SQRT(H4)=K=WAVENUMBER=1/LAMBDA_SLASH                           00130008
C     Z=0.03478*ZP*ZT*ARED/K                                            00140008
C     STPLTH  INTEGRATION STEPS IN FERMI (0.1 IS TYPICAL)               00150008
C     V1(1)=  INTRINSIC SPIN OF PROJECTILE (S)                          00160008
C     V1(2)=  INTRINSIC SPIN OF TARGET PRESUMABLY                       00170005
C     V1(3)=  LMAX MAX ORBITAL ANG MOM+1                                00180005
C     V(1 )=  REAL POT RADIUS                                           00190005
C     V(2 )=  REAL POT DIFFUSENESS                                      00200005
C     V(3 )=  IMAG POT RADIUS                                           00210005
C     V(4 )=  IMAG POT DIFFUSENESS                                      00220007
C     V(5 )=  1 SURFACE IMAG, 0 VOLUME IMAG                             00230007
C     V(6 )=  DEPTH SPIN ORBIT POT                                      00240005
C     V(7 )=  DEPTH REAL POT                                            00250005
C     V(8 )=  DEPTH IMAG POT                                            00260005
C     V(9 )=  COULOMB RADIUS                                            00270005
C     V(10)=  SPIN ORBIT POT RADIUS                                     00280005
C     V(11)=  SPIN ORBIT POT DIFFUSENESS                                00290005
C-------------------------------------------------------------------    00300008
C      DOUBLE PRECISION A,B,D,E,F,G,H,Q,R,S,U,Y,A1,A2,B1,B7,DT,D1,HY,HZ, 00310000
C     1                 H2,P5,P6,P7,P8,P9,RB,SG,TM,T1,T2,T3,T4,T5,T6,T7, 00320000
C     2                 T8,T9,U1,U2,V4,V5,W2,Y1,Y2,Z1,Z2,DTT,DT3,HZ3,    00330000
C     3                 T101,T102,TT1,TT2                                00340012
C-----------------------------------------------------------------------00350000
C     MAYBE UNINITIALIZED: Z1,A1,A2,V4
C
C     I.Giese 2007
      SAVE
C
      B1 = 0.                                                           00360000
 1    I1=2.0*V1(1) + 2                                                  00370000
      I3=I1+2                                                           00380000
      I4=I1*(I1-2)                                                      00390000
      J1=I1-1                                                           00400000
      B7=V(1)                                                           00410000
      V(1)=DABS(V(1))                                                   00420000
      RB=V(1)+9.*V(2)                                                   00430000
      RB=DMAX1(RB,V(10)+9.0*V(11))                                      00440000
      T1=V(3)+9.*V(4)                                                   00450000
      IF(RB-T1)2,3,3                                                    00460000
 2    RB=T1                                                             00470000
 3    IRB=10.*RB                                                        00480000
      RB=IRB                                                            00490000
      RB=RB/10.                                                         00500000
      M4=RB/STPLTH                                                      00510000
      IF(M4-299)5,5,4                                                   00520000
 4    M4=299                                                            00530000
 5    D1=RB/FLOAT(M4)                                                   00540000
      M4=M4+1                                                           00550000
      M1=M4+1                                                           00560000
      M3=M4+2                                                           00570000
      N1=(V1(3)+1.0)                                                    00580000
      V1(3)=FLOAT(N1-1)                                                 00590000
      Z2=Z*Z                                                            00600000
      DT=2.*D1                                                          00610000
      DTT=D1*D1/12.                                                     00620000
      W2=W1                                                             00630000
      W1=W1*DTT                                                         00640000
      DT3=-2.*DTT                                                       00650000
      H2=1.+DTT*H4                                                      00660000
      HY=DT3*H1*Z                                                       00670000
      S(16,1)=1.                                                        00680000
      S(16,2)=1.                                                        00690000
      S(16,3)=0.                                                        00700000
      S(16,4)=0.                                                        00710000
      T1=1.                                                             00720000
      T2=2.                                                             00730000
      T3=0.                                                             00740000
C------------------------                                               00750005
      DO 6 I=1,15                                                       00760005
      J=16-I                                                            00770000
      T7=T1*Z/T2                                                        00780000
      T6=-T3*(T3+1.)+Z2                                                 00790000
      T4=T6/T2                                                          00800000
      T5=(2.+T6)/T2                                                     00810000
      S(J,1)=T7*S(J+1,1)-T4*S(J+1,3)                                    00820000
      S(J,2)=T7*S(J+1,2)-T5*S(J+1,4)                                    00830000
      S(J,3)=T7*S(J+1,3)+T4*S(J+1,1)                                    00840000
      S(J,4)=T7*S(J+1,4)+T5*S(J+1,2)                                    00850000
      T1=T1+2.                                                          00860000
      T2=T2+2.                                                          00870000
 6    T3=T3+1.                                                          00880000
C------------------------                                               00890005
      TM=RB                                                             00900000
      IF(Z)7,10,7                                                       00910000
 7    DO 9 I=1,4                                                        00920005
      T1=( DEXP((13.816+DLOG( DABS(S(1,I))))/15.0))/H1                  00930000
      IF(T1-TM)9,9,8                                                    00940000
 8    TM=T1                                                             00950000
 9    CONTINUE                                                          00960000
 10   M2=(TM-RB)/D1 + 1                                                 00970000
      TM=RB+D1*FLOAT(M2)                                                00980000
      T1=Z2+16.                                                         00990000
      SG(1)=-Z+Z*(DLOG(T1))/2.0+3.5*DATAN(Z/4.0)-DATAN(Z)               01000000
     1 -DATAN(Z/2.0)-DATAN(Z/3.)                                        01010000
     2      -Z*(1.+(Z2-48.)/(30.*T1*T1)+(Z2*Z2-160.*Z2+1280.)/(105.*T1* 01020000
     3T1*T1*T1))/(12.*T1)                                               01030000
      SG(2)=SG(1)-1.5707963+DATAN(Z)                                    01040000
      T1=TM+DT                                                          01050000
      DO13I=1,2                                                         01060000
      T1=T1-D1                                                          01070000
      T2=T1*H1                                                          01080000
      T3=T2-Z*DLOG(2.0*T2)                                              01090000
      DO12J=1,2                                                         01100000
      T7=0.                                                             01110000
      T8=0.                                                             01120000
      DO11K=1,15                                                        01130000
      T7=(T7+S(K,J))/T2                                                 01140000
 11   T8=(T8+S(K,J+2))/T2                                               01150000
      T7=T7+1.                                                          01160000
      T4=T3+SG(J)                                                       01170000
      T5=DCOS(T4)                                                       01180000
      T6=DSIN(T4)                                                       01190000
 12   G(J,I)=T7*T5-T8*T6                                                01200000
      R(1,I)=H2+HY/T1                                                   01210000
 13   R(2,I)=R(1,I)+DT3/(T1*T1)                                         01220000
C-----------------------------------                                    01230005
      DO 14 I=1,M2                                                      01240005
      T1=T1-D1                                                          01250000
      R(1,3)=H2+HY/T1                                                   01260000
      R(2,3)=R(1,3)+DT3/(T1*T1)                                         01270000
      DO 14 J=1,2                                                       01280005
      G(J,3)=((12.-10.*R(J,2))*G(J,2)-R(J,1)*G(J,1))/R(J,3)             01290000
      DO 14 K=1,2                                                       01300005
      R(J,K)=R(J,K+1)                                                   01310000
 14   G(J,K)=G(J,K+1)                                                   01320000
C-----------------------------------                                    01330005
      T1=T1+D1                                                          01340000
      DO26I=1,2                                                         01350000
      T2=T1*H1                                                          01360000
      T3=1./T2                                                          01370000
      T1=T1-D1                                                          01380000
      T7=0.                                                             01390000
      N4=0                                                              01400000
      N2=(T2/1.4142)*DSQRT(25.-2.*Z*T3+10.*DSQRT((Z*T3-.5)**2+6.))      01410000
      IF(N2-N1-8)15,16,16                                               01420000
 15   N2=N1+8                                                           01430000
 16   IF (N2-500) 17,17,46                                              01440000
 17   T6=FLOAT(N2)                                                      01450000
      N3=N2+1                                                           01460000
      T5=T7                                                             01470000
      H(N3+1)=0.                                                        01480000
      H(N3)=1.0E-20                                                     01490000
      A(N3)=DSQRT(Z2+(T6+1.0)**2)/(T6+1.0)                              01500000
      DO21K=1,N2                                                        01510000
      M=N3-K                                                            01520000
      IF(N4-M)18,19,19                                                  01530000
 18   A(M)=DSQRT(Z2+T6*T6)/T6                                           01540000
      B(M)=(2.*T6+1.)*(Z/(T6*(T6+1.))+T3)                               01550000
      T6=T6-1.                                                          01560000
 19   H(M)=(B(M)*H(M+1)-A(M+1)*H(M+2))/A(M)                             01570000
      IF(DABS(H(M+2))-(10.0**30)) 21,21,20                              01580000
 20   H(M)=H(M)/(10.0**25)                                              01590000
      H(M+1)=H(M+1)/(10.0**25)                                          01600000
 21   CONTINUE                                                          01610000
      N4=N2                                                             01620000
      N2=N2+10                                                          01630000
      T7=H(2)/H(1)                                                      01640000
      IF(DABS((T5-T7)/T7)-0.0001) 23,23,22                              01650000
 22   IF(N2.LE.500) GO TO 16                                            01660000
      N2 = 500                                                          01670000
 23   T5=1./(A(1)*(H(1)*G(2,I)-H(2)*G(1,I)))                            01680000
      F(1,I)=T5*H(1)                                                    01690000
      F(2,I)=T5*H(2)                                                    01700000
      DO26K=3,N1                                                        01710000
      IF(DABS(H(K)/H(K-1))-10.0**15) 25,25,24                           01720000
 24   T5=T5/(10.0**25)                                                  01730000
 25   F(K,I)=T5*H(K)                                                    01740000
 26   G(K,I)=(B(K-2)*G(K-1,I)-A(K-2)*G(K-2,I))/A(K-1)                   01750000
C-----------------------------------                                    01760005
      Q(1)=0.                                                           01770000
      Q(2)=0.                                                           01780000
      H(1)=0.                                                           01790000
      H(2)=0.                                                           01800000
      A(1)=0.                                                           01810000
      A(2)=1.0E-20                                                      01820000
      B(1)=0.                                                           01830000
      B(2)=1.0E-20                                                      01840000
      HZ3=H2+1.5*HY/V(9)                                                01850000
      HZ=-HY/(2.*(V(9)**3))                                             01860000
      T101=1.0/DEXP(V(10)/V(11))                                        01870000
      T1=1.0/DEXP(V(1)/V(2))                                            01880000
      T102=DEXP(D1/V(11))                                               01890000
      T2=DEXP(D1/V(2))                                                  01900000
      IF(B7)27,28,28                                                    01910000
 27   A2=V(5)*V(5)/16.                                                  01920000
      V(5)=1.                                                           01930000
      A1=4.*W2*A2                                                       01940000
      B1=DEXP(4.0*A2*H4)                                                01950000
 28   V5=V(5)                                                           01960000
      IF(V5)29,30,30                                                    01970000
 29   V(5)=-V5                                                          01980000
      V4=V(4)                                                           01990000
      V(4)=0.69*V(4)                                                    02000000
 30   T9=V(8)*(1.-V(5))                                                 02010000
      T3=1.0/DEXP(V(3)/V(4))                                            02020000
      T4=DEXP(D1/V(4))                                                  02030000
      T6=0.                                                             02040000
C-----------------------------------------------------                  02050005
      DO 40 K=1,M4                                                      02060005
      T6=T6+D1                                                          02070000
      Y(K)=T6*T6                                                        02080000
      T1=T1*T2                                                          02090000
      T101=T101*T102                                                    02100000
      T3=T3*T4                                                          02110000
      T5=V(7)/(1.+T1)                                                   02120000
      T7=1./(1.+T3)                                                     02130000
      IF(V5)31,34,34                                                    02140000
 31   T8=((T6-V(3))/V4)**2                                              02150000
      IF(T8-10.)33,32,32                                                02160000
 32   T8=0.                                                             02170000
      GO TO 37                                                          02180000
 33   T8=V(8)*DEXP(-T8)                                                 02190000
      GO TO 37                                                          02200000
 34   T8=4.*T3*T7*T7*V(8)                                               02210000
      IF(B7)35,37,37                                                    02220000
 35   P5=A2/(T5*T5+T8*T8)                                               02230000
      P8=T1/(1.+T1)                                                     02240000
      P9=T3*T7                                                          02250000
      P6=-T5*P8/V(2)                                                    02260000
      P7=T8*(1.-2.*P9)/V(4)                                             02270000
      P8=P6*(1.-2.*P8)/V(2)                                             02280000
      P9=T8*(1.-6.*P9*(1.-P9))/(V(4)*V(4))                              02290000
      U2=P5*((T5*P6+T8*P7)*2./T6+T5*P8+T8*P9)                           02300000
      Y2=P5*((T5*P7-T8*P6)*2./T6+T5*P9-T8*P8)                           02310000
      Y1(1)=T8/(B1*B1+2.*B1*A1*T5)                                      02320000
      U1(1)=(T5+T8*A1*Y1(1))/(B1+A1*T5)                                 02330000
      DO36J=1,6                                                         02340000
      P5=A1*Y1(J)-Y2                                                    02350000
      P6=DSIN(P5)                                                       02360000
      P5=DCOS(P5)                                                       02370000
      P7=1.0/(B1*DEXP(A1*U1(J)-U2))                                     02380000
      U1(J+1)=(T5*P5+T8*P6)*P7                                          02390000
 36   Y1(J+1)=(T8*P5-T5*P6)*P7                                          02400000
      T5=U1(7)-((U1(7)-U1(6))**2)/(U1(7)-2.*U1(6)+U1(5))                02410000
      T8=Y1(7)-((Y1(7)-Y1(6))**2)/(Y1(7)-2.*Y1(6)+Y1(5))                02420000
 37   H(K+2)=W1*(T9*T7+V(5)*T8)                                         02430000
      U(K)=2.*W1*V(6)*T101/(V(11)*T6*((1.+T101)**2))                    02440000
      IF(T6-V(1))38,39,39                                               02450000
 38   E(K)=W1*T5+HZ3+HZ*Y(K)                                            02460000
      GO TO 40                                                          02470000
 39   E(K)=W1*T5+H2+HY/T6                                               02480000
 40   CONTINUE                                                          02490000
      T8=0.                                                             02500000
C------------------------------------------------------------------     02510002
C                                            I ORBIT AM LOOP            02520002
      DO 45 I=1,N1                                                      02530005
      I2=2*I                                                            02540000
      T1=DTT*T8*(T8+1.)                                                 02550000
      T8=T8+1.                                                          02560000
      DO41K=1,M4                                                        02570000
 41   D(K)=E(K)-T1/Y(K)                                                 02580000
C--------------------------------------------                           02590002
C                                J INTRINSIC SPIN LOOP                  02600002
      DO45J=1,J1                                                        02610000
      L=I2-I3+2*J                                                       02620000
      IF(IABS(I2-I1)-L)43,43,42                                         02630000
 42   T(J,I)=0.                                                         02640000
      GO TO 45                                                          02650000
 43   T9=(FLOAT(L*(L+2)-I2*(I2-2)-I4))/4.                               02660000
      DO44K=1,M4                                                        02670000
      Q(K+2)=D(K)+T9*U(K)                                               02680000
      T3=12.-10.*Q(K+1)                                                 02690000
      T4=10.*H(K+1)                                                     02700000
      T1=T3*A(K+1)-Q(K)*A(K)+T4*B(K+1)+H(K)*B(K)                        02710000
      T2=T3*B(K+1)-Q(K)*B(K)-T4*A(K+1)-H(K)*A(K)                        02720000
      T3=Q(K+2)**2+H(K+2)**2                                            02730000
      A(K+2)=(Q(K+2)*T1+H(K+2)*T2)/T3                                   02740000
 44   B(K+2)=(Q(K+2)*T2-H(K+2)*T1)/T3                                   02750000
      T3=A(M3)**2+B(M3)**2                                              02760000
      T1=(A(M1)*A(M3)+B(M1)*B(M3))/T3                                   02770000
      T2=(A(M3)*B(M1)-A(M1)*B(M3))/T3                                   02780000
      T5=F(I,2)-F(I,1)*T1                                               02790000
      T6=F(I,1)*T2                                                      02800000
      T3=T5-G(I,1)*T2                                                   02810000
      T4=G(I,2)-G(I,1)*T1+T6                                            02820000
      T7 = (T3/T4)*T3+ T4                                               02830000
      T1=(T3*T5+T4*T6)/T7                                               02840000
      T2=(T4*T5-T3*T6)/T7                                               02850000
      T7 = T4                                                           02860000
      T1 = T1/T7                                                        02870000
      TT1=T1                                                            02880011
      IF(T1.LT.0.1D-15)TT1=0.                                           02890012
      T2 = T2/T7                                                        02900000
      TT2=T2                                                            02910011
      IF(T2.LT.0.1D-15)TT2=0.                                           02920012
C     T(J,I)=4.*(T1-T1**2-T2**2)                                        02930009
      T(J,I)=4.*(T1-TT1*TT1-TT2*TT2)                                    02940011
 45   CONTINUE                                                          02950000
C----------------------------------------     END ORBIT AM LOOP         02960002
C--------------------------------------------------------------------   02970002
 46   CONTINUE                                                          02980000
      RETURN                                                            02990000
      END                                                               03000000
